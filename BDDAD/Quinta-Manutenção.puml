@startuml Quinta Manutenção

/'TODO #1:- Verificar se a Designação de um Campo é única e se estas 
devem seguir um conjunto de regras;'/
/'TODO #2:- Determinar o valor minímo de uma qualquer Área;'/
/'Constraints:- [[Area, CHECK(Area > Mínimo)]]'/
entity Campo {
    * ID: INTEGER <<PK>>
    --
    Designacao: VARCHAR2(255) NOT NULL
    Area: NUMBER NOT NULL
}

/'Triggers:-
    #1: Verificar que uma Cultura não é simultaneamente uma Cultura_Temporaria
    e Cultura_Permanente;'/
entity Cultura {
    * ID: INTEGER <<PK>>
    --
    Especie_Vegetal_ID: INTEGER <<FK>> NOT NULL UNIQUE
}

/'Constraints:- [[Campo_ID, Data_Inicio_Cultura, UNIQUE(Campo_ID, Data_Inicio_Cultura)], 
[Data_Fim_Cultura, CHECK(Data_Fim_Cultura < Data_Inicio_Cultura)]]'/
entity Campo_Cultura {
    * Campo_ID: INTEGER <<PK>> <<FK>>
    * Cultura_ID: INTEGER <<PK>> <<FK>>
    * Data_Inicio_Cultura: DATE <<PK>>
    --
    Data_Fim_Cultura: DATE
}

entity Plano {
    * ID: INTEGER <<PK>>
    --
    Tipo_Plano_ID: INTEGER <<FK>> NOT NULL
    Campo_ID: INTEGER <<FK>>
    Cultura_ID: INTEGER <<FK>>
    Data_Inicio_Cultura: DATE <<FK>>
}

entity Plano_Rega {
    * Plano_ID: INTEGER <<PK>> <<FK>>
    --
}

entity Plano_Aplicacao_Produto {
    * Plano_ID: INTEGER <<PK>> <<FK>>
    --
}

/'Constraints:- [[Quantidade, CHECK(Quantidade > 0)]]'/
entity Aplicacao_Produto {
    * Campo_ID: INTEGER <<PK>>
    * Data_Aplicacao_Produto: DATE <<PK>>
    --
    Plano_ID: INTEGER <<FK>> NOT NULL
    Produto_ID: INTEGER <<FK>> NOT NULL
    Quantidade NUMBER NOT NULL
}

/'Constraints:- [[Quantidade, CHECK(Quantidade > 0)]]'/
entity Rega {
    * Campo_ID: INTEGER <<PK>>
    * Data_Rega: DATE <<PK>>
    --
    Plano_ID: INTEGER <<FK>> NOT NULL
    Quantidade: NUMBER NOT NULL
}

entity Tipo_Plano {
    * ID: INTEGER <<PK>>
    --
    Designacao: VARCHAR2(255) NOT NULL UNIQUE
}

entity Produto {
    * ID: INTEGER <<PK>>
    --
    Classificacao_ID: INTEGER <<FK>> NOT NULL
    Formulacao_ID: INTEGER <<FK>> NOT NULL
    Ficha_Tecnica_ID: INTEGER <<FK>> NOT NULL UNIQUE
    Nome: VARCHAR2(255) NOT NULL UNIQUE
}

entity Classificacao {
    * ID: INTEGER <<PK>>
    --
    Designacao: VARCHAR2(255) NOT NULL UNIQUE
}

entity Formulacao {
    * ID: INTEGER <<PK>>
    --
    Tipo: VARCHAR2(255) NOT NULL UNIQUE
}

entity Ficha_Tecnica {
    * ID: INTEGER <<PK>>
    --
    Humidade: NUMBER
    pH: NUMBER
    Peso_Especifico: NUMBER
    Formulacao_Peletizada: INTEGER
}

/'Constraints:- [[Numero, CHECK(Numero > 0)]]'/
entity Elemento {
    * ID: INTEGER <<PK>>
    --
    Nome: VARCHAR2(255) NOT NULL UNIQUE
    Simbolo: VARCHAR(2) NOT NULL UNIQUE
    Numero: INTEGER NOT NULL
}

/'Constraints:- [[Percentagem, CHECK(Percentagem > 0)]]'/
entity Ficha_Tecnica_Elemento {
    * Ficha_Tecnica_ID: INTEGER <<PK>> <<FK>>
    * Elemento_ID: INTEGER <<PK>> <<FK>>
    --
    Percentagem: NUMBER NOT NULL
}

entity Substancia {
    * ID: INTEGER <<PK>>
    --
    Nome: VARCHAR2(255) NOT NULL UNIQUE
}

/'Constraints:- [[Percentagem, CHECK(Percentagem > 0)]]'/
entity Ficha_Tecnica_Substancia {
    * Ficha_Tecnica_ID: INTEGER <<PK>> <<FK>>
    * Substancia_ID: INTEGER <<PK>> <<FK>>
    --
    Percentagem: NUMBER NOT NULL
}

Campo ||-d-|{ Campo_Cultura
Campo ||-r-|{ Rega
Campo ||-l-|{ Aplicacao_Produto

Cultura ||-u-|{ Campo_Cultura

Campo_Cultura ||--d--|{ Plano

Tipo_Plano ||-u-o{ Plano

Plano_Rega ||-u-|| Plano
Plano_Rega ||-d-|{ Rega

Plano_Aplicacao_Produto ||--u--|| Plano
Plano_Aplicacao_Produto ||-r-|{ Aplicacao_Produto

Classificacao ||-d-o{ Produto

Formulacao ||-d-o{ Produto

Produto ||-d-|| Ficha_Tecnica
Produto ||-u-o{ Aplicacao_Produto

Ficha_Tecnica ||-d-|{ Ficha_Tecnica_Elemento
Ficha_Tecnica ||-d-|{ Ficha_Tecnica_Substancia

Elemento ||-u-|{ Ficha_Tecnica_Elemento

Substancia ||-u-|{ Ficha_Tecnica_Substancia

@enduml